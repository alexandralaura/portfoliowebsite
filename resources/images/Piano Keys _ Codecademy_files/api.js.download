extole.define("https://origin.xtlo.net/type=core:clientId=21243602:coreAssetsVersion=160/common/api.js","https://origin.xtlo.net/type=core:clientId=21243602:coreAssetsVersion=160/common/ExtoleError.js https://origin.xtlo.net/type=core:clientId=21243602:coreAssetsVersion=160/common/collection.js https://origin.xtlo.net/type=core:clientId=21243602:coreAssetsVersion=160/common/logger.js https://origin.xtlo.net/type=core:clientId=21243602:coreAssetsVersion=160/common/ajax.js https://origin.xtlo.net/type=core:clientId=21243602:coreAssetsVersion=160/common/Timer.js https://origin.xtlo.net/type=core:clientId=21243602:coreAssetsVersion=160/common/client/program.js https://origin.xtlo.net/type=core:clientId=21243602:coreAssetsVersion=160/common/client/token-store.js".split(" "),
function(v,r,y,w,B,z,C){function A(){var h=this,n,l,t,p,d;this.withRequestSummary=function(a){p=a;return h};this.withResponseSummary=function(a){d=a;return h};this.withStatusCode=function(a){t=a;return h};this.withMessage=function(a){l=a;return h};this.asDebug=function(){n="debug";return h};this.asInfo=function(){n="info";return h};this.asWarn=function(){n="warn";return h};this.asError=function(){n="error";return h};this.log=function(){if(!p.url.match(y.LOGGING_ENDPOINT)){var a=[];t&&a.push("Status "+
t);l&&a.push(l);y[n](a.join(" "),{request:p,response:d})}}}var D=/^\/api\/v\d\//,E=z.getProgramDomain();return new function(){function h(d,a,c){l("get",d,null,a,c)}function n(d,a,c){l("delete",d,null,a,c)}function l(d,a,c,f,q){f=f||function(){};q=q||{};a=z.getProtocol()+E+t(a);var g=r.merge({"content-type":"application/json","x-extole-app":"javascript_sdk"},q.headers);g=Object.keys(g).reduce(function(b,e){b[e.toLowerCase()]=g[e];return b},{});q.noAuthorizationHeader||(g.authorization=C.get());c="multipart/form-data"===
g["content-type"]?w.convertToMultipartFormData(g,c):"application/x-www-form-urlencoded"===g["content-type"]||q.convertToFormUrlEncoded?w.convertToFormUrlEncoded(g,c):r.merge({},c);w({timeout:2E4,url:a,type:d,complete:function(b){b=b||null;var e=null;if(b)try{b=JSON.parse(b)}catch(k){e=new v("Couldn't parse as JSON response from request, response: '"+b+"'"),b=null}f&&f(e,b);b=r.merge({},b);b.timestamp=String((new Date).getTime());(new A).withRequestSummary(u).withResponseSummary(b).withMessage("Completed api request").asDebug().log()},
error:function(b,e){try{var k=JSON.parse(this.response)}catch(m){k={statusText:this.statusText,status:e}}f&&f(k);b=r.merge({},k);b.timestamp=String((new Date).getTime());b=(new A).withRequestSummary(u).withResponseSummary(b);e=String(e||k.http_status_code);"4"===e[0]?b.asInfo().withMessage("Failed api request").withStatusCode(e).log():b.asError().withMessage("Failed api request").withStatusCode(e).log()},data:c,headers:g,xhrFields:{withCredentials:!0}});var u={url:a,type:d,headers:g,data:c,timestamp:String((new Date).getTime())}}
function t(d){return d.match(D)?d:"/api/v4"+d}var p=!1;this.poll=function(d,a,c){function f(){var k=g.getElapsedTime();c.headers=r.merge({"X-Extole-Polling-Time":k},c.headers);h(d,function(m,x){if(p)m=new v("poll cancelled","cancelled");else if(u&&k>=u)m=new v("poll timed out after "+k+"ms","timed_out");else if(e(m,x)){setTimeout(f,b||300);return}a(m||x.error,x)},c)}function q(k,m){return k?!1:m&&"PENDING"===m.status}p=!1;a=a||function(){};c=c||{};var g=(new B).start(),u=c.pollTimeout||2E4,b=c.pollInterval||
300,e=c.retryCondition||q;f()};this.cancel=function(){p=!0};this.get=h;this.post=function(d,a,c,f){l("post",d,a,c,f)};this.put=function(d,a,c,f){l("put",d,a,c,f)};this.delete=this.del=n}});